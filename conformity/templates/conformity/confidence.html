{% extends "global/Base.html" %}
{% load staticfiles otree_tags %}


{% block title %}
How confident are you in your guess?
{% endblock %}


{% block content %}

<p> On this page, we would like to find out how confident you are in your guess that the median commitment by all players OTHER THAN YOU in this round is <b>{{belief}} </b> {% ifequal committed one %} minute {% else %} minutes {% endifequal %} of waiting. </p>

<p> Think of each of the rows of the table below as asking: "Would you rather receive {{Constants.confidenceBonus}} if your guess of the median is correct or would you rather receive [$X] for sure?" </p>

<p>The computer will randomly choose one of the rows for the round selected for payment and implement your decision. Hence, if you have chosen the left hand side entry for the row selected by the computer, we will pay you {{left_side}} if your guess is within {{Constants.accuracy}} minute of the true median of everyone else's commitment in the randomly selected round. If you have chosen the right hand side entry of the randomly selceted row, we will pay you what it states on the right hand side of the row in question. </p>

<p> Note: you can switch from the left to the right hand side option for all decisions at once by simply clicking any one row. </p>


    <table class="table table-striped">
        <colgroup>
            <col width="45%">
            <col width="10%">
            <col width="45%">
        </colgroup>
        <tr>
            <td align="right"><b>Left Hand Side</b></td>
            <td></td>
            <td align="left"><b>Right Hand Side</b></td>
        </tr>
        {% for amount in right_side_amounts %}
            <tr>
                <td align="right">
                     <b>{{left_side}}</b> if guess (<b>{{belief}}{% ifequal committed one %} minute{% else %} minutes{% endifequal %}</b>) is <b>within {{Constants.accuracy}} minute</b> of true median </td>
                <td align="middle">
                    <input type="radio" name="amount_{{ amount|json }}" value="left"
                           required>&nbsp;&nbsp;
                    <input type="radio" name="amount_{{ amount|json }}"
                           value="right" data-amount="{{ amount|json }}" required>
                </td>
                <td align="left">
                    <b>{{amount}}</b> </td>
            </tr>
        {% endfor %}
    </table>


    {{ form.errors }}
    <input type="hidden" name="confidence" id="switchpoint"
           value="3.5">
           
    {% next_button %}


{% endblock %}          


{% block scripts %}
<script>
$(document).ready(function () {
    $('input[type=radio]').change(
            function () {
                var clickedRadio = this;
                var afterClickedRadio = false;
                var clickedNumber = 100;

                var radios = document.querySelectorAll('input[type=radio]');

                for (i = 0; i < radios.length; ++i) {
                    var radio = radios[i];
                    if (radio == clickedRadio) {
                        afterClickedRadio = true;
                        continue;
                    }
                    if (!afterClickedRadio  && radio.value == 'left') {
                        radio.checked = true;
                    }
                    if (afterClickedRadio && radio.value == 'right' ) {
                        radio.checked = true;
                    }
                }
                for (i = 0; i < radios.length; ++i) {
                    var radio = radios[i];
                    if (radio == clickedRadio) {
                        radio.checked = true;
                    }
                }
            }
    );
});

    $('button').click(function() {
        var radios = document.querySelectorAll('input[type=radio]');


        for (i = 0; i < radios.length; ++i) {
            var radio = radios[i];
            if (radio.value == 'right' && radio.checked) {
                $('#switchpoint').val(radio.dataset.amount);
                break;
            } else {
                $('#switchpoint').val(9999);
            }
        }
    });

</script>
{% endblock %}